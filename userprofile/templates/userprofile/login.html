{% load widget_tweaks %}
{% load static %}
<!DOCTYPE html>
<html lang="en" x-data="{ darkMode: false }" x-init="darkMode = localStorage.getItem('darkMode') === 'true' || (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)" :class="{ 'dark': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | WealthNetTrader</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {500: '#0ea5e9', 600: '#0284c7', 700: '#0369a1'},
                        background: '#f8fafc',
                    }
                }
            }
        }
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aquawolf04/font-awesome-pro@5cd1511/css/all.css">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: "Inter", sans-serif; }
        button:hover { transform: translateY(-1px); transition: all .3s; }
        button:active { transform: translateY(0); }
    </style>
</head>

<body class="min-h-screen flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 pt-16 lg:pt-20">

    <!-- Logo -->
  <div class="absolute top-4 left-4">
   <a href="{% url 'home' %}">
        <div class="absolute inset-0 bg-primary-400/20 rounded-xl blur-lg group-hover:bg-primary-400/30 transition-all duration-300"></div>
        <img src="{% static 'images/wealthnettrader.png' %}" alt="Wealth-Logo" class="relative h-10 lg:h-10 w-auto rounded-xl">
    </a>
</div>

    <!-- Dark Mode Toggle -->
    <div class="fixed top-4 right-4">
        <button @click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)" 
            class="p-3 rounded-2xl bg-white/80 dark:bg-gray-800/80 text-gray-700 dark:text-gray-300 shadow-lg hover:shadow-xl border border-gray-200/50 dark:border-gray-700/50 backdrop-blur-xl transition-all duration-300 hover:scale-110">
            <i class="fa-solid fa-sun" x-show="darkMode"></i>
            <i class="fa-solid fa-moon" x-show="!darkMode"></i>
        </button>
    </div>

    <!-- Login Card -->
   <div class="w-full max-w-sm bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-200/50 dark:border-gray-700/50 p-6">

    <!-- Font Awesome Person Icon -->
    <div class="text-center mb-3">
        <i class="fa-solid fa-user text-3xl text-gray-800 dark:text-gray-200"></i>
    </div>

    <div class="text-center mb-6">
        <h1 class="text-xl font-bold text-gray-900 dark:text-white mb-1">Welcome</h1>
        <p class="text-sm text-gray-600 dark:text-gray-400">Login to your Wallet</p>
    </div>

    <form method="POST" action="{% url 'userprofile:login' %}">
        {% csrf_token %}

        {% if form.non_field_errors %}
            <div class="mb-3 text-red-500 text-sm">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}

        <!-- Username -->
        <div class="mb-4">
            <label for="{{ form.username.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1">Username</label>
            {{ form.username|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
            {{ form.username.errors }}
        </div>

        <!-- Password -->
        <div class="mb-4 relative">
            <label for="{{ form.password.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1">Password</label>
            {{ form.password|add_class:"w-full pl-3 pr-10 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
            <!-- Eye Icon -->
            <button type="button" id="togglePassword" class="absolute right-3 top-9 text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition">
                <i class="fa-solid fa-eye"></i>
            </button>
            {{ form.password.errors }}
        </div>

        <!-- Forgot Password -->
        <div class="text-right mb-4">
            <a href="{% url 'userprofile:reset-password' %}" class="text-xs text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium transition">Forgot Password?</a>
        </div>

        <!-- Submit -->
        <button type="submit" class="w-full py-3 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 text-sm">
            Sign In
        </button>
    </form>

    <!-- Register Link -->
    <div class="mt-6 text-center">
        <p class="text-sm text-gray-600 dark:text-gray-400">
            Don't have a Wallet ?
            <a href="{% url 'userprofile:register' %}" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-semibold transition-colors">
                Create one
            </a>
        </p>
    </div>
</div>

<!-- Password Toggle Script -->
<script>
    const togglePassword = document.getElementById("togglePassword");
    const passwordField = document.getElementById("id_password");

    if (togglePassword && passwordField) {
        togglePassword.addEventListener("click", function () {
            const type = passwordField.getAttribute("type") === "password" ? "text" : "password";
            passwordField.setAttribute("type", type);
            this.innerHTML = type === "password"
                ? '<i class="fa-solid fa-eye"></i>'
                : '<i class="fa-solid fa-eye-slash"></i>';
        });
    }
</script>


    <div class="mt-6 text-center text-xs text-gray-500 dark:text-gray-500">
        &copy; 2021 WealthNetTrader. All Rights Reserved.
    </div>
   <!-- ======== PRELOADER START ======== -->
<div id="preloader" class="fixed inset-0 bg-gray-950 flex flex-col items-center justify-center z-[9999] transition-opacity duration-700">
  <div class="flex space-x-2 mb-6">
    <div class="bar h-8 w-2 rounded-full bg-[#048ace] animate-bar"></div>
    <div class="bar h-10 w-2 rounded-full bg-[#04b3ff] animate-bar delay-100"></div>
    <div class="bar h-6 w-2 rounded-full bg-[#048ace] animate-bar delay-200"></div>
    <div class="bar h-12 w-2 rounded-full bg-[#04b3ff] animate-bar delay-300"></div>
    <div class="bar h-8 w-2 rounded-full bg-[#048ace] animate-bar delay-400"></div>
  </div>

  <h1 class="text-xl sm:text-2xl font-bold text-[#048ace] tracking-wide">WealthNetTrader</h1>
</div>
<!-- ======== PRELOADER END ======== -->

<!-- ======== STYLES ======== -->
<style>
  /* Smooth fadeout */
  #preloader.fade-out {
    opacity: 0;
    pointer-events: none;
  }

  /* Bar animation */
  @keyframes barUpDown {
    0%, 100% {
      transform: scaleY(0.4);
      opacity: 0.7;
    }
    50% {
      transform: scaleY(1);
      opacity: 1;
    }
  }

  .animate-bar {
    animation: barUpDown 1s ease-in-out infinite;
    transform-origin: bottom;
  }

  .delay-100 { animation-delay: 0.1s; }
  .delay-200 { animation-delay: 0.2s; }
  .delay-300 { animation-delay: 0.3s; }
  .delay-400 { animation-delay: 0.4s; }
</style>

<!-- ======== SCRIPT ======== -->
<script>
  window.addEventListener("load", () => {
    const preloader = document.getElementById("preloader");
    setTimeout(() => {
      preloader.classList.add("fade-out");
      setTimeout(() => preloader.style.display = "none", 700);
    }, 700); // Slight delay before fade
  });
</script>
</body>
</html>
