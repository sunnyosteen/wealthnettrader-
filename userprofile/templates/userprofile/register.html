{% load widget_tweaks %}
{% load static %}
<!DOCTYPE html>
<html lang="en" x-data="{ darkMode: false }" x-init="darkMode = localStorage.getItem('darkMode') === 'true' || (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)" :class="{ 'dark': darkMode }">
<head>
    <title>Create Account | WealthNetTrader</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <meta name="apple-mobile-web-app-title" content="">
    <meta name="application-name" content="">
    <meta name="description" content="#">
    <link rel="shortcut icon" href="#">
    
    <!-- Dark mode initialization -->
    <script>
        // Dark mode initialization before page loads
        const isDarkMode = localStorage.getItem('darkMode') === 'true' || 
                          (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches);
        
        if (isDarkMode) {
            document.documentElement.classList.add('dark');
        }
    </script>
    
    <!-- Tailwind CSS with custom color variables -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: { // Dynamic primary colors from appearance settings
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            DEFAULT: '#0ea5e9',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            foreground: '#ffffff',
                        },
                        secondary: { // Dynamic secondary colors from appearance settings
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            DEFAULT: '#64748b',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            foreground: '#0f172a',
                        },
                        accent: { // Dynamic accent colors from appearance settings
                            50: '#fdf2f8',
                            100: '#fce7f3',
                            200: '#fbcfe8',
                            300: '#f9a8d4',
                            400: '#f472b6',
                            DEFAULT: '#ec4899',
                            500: '#ec4899',
                            600: '#db2777',
                            700: '#be185d',
                            foreground: '#ffffff',
                        },
                        background: '#f8fafc',
                        foreground: '#1e293b',
                        card: {
                            DEFAULT: '#ffffff',
                            foreground: '#1e293b',
                        },
                        muted: {
                            DEFAULT: '#f1f5f9',
                            foreground: '#64748b',
                        },
                        border: '#e2e8f0',
                        input: '#e2e8f0',
                        ring: '#0ea5e9',
                        
                        // Specific colors from original design for gradients/highlights
                        'gradient-pink-from': '#ec4899',
                        'gradient-purple-via': '#a855f7',
                        'gradient-indigo-to': '#4f46e5',
                        
                        'mobile-header-bg': '#1e293b', // Dark slate for mobile top section
                        'mobile-header-text': '#f1f5f9', // Light text for mobile top section
                        
                        'yellow-action': '#facc15',
                        'green-positive': '#22c55e',
                        'red-negative': '#ef4444',
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'top': '0 -4px 12px -1px rgba(0,0,0,0.05), 0 -2px 8px -1px rgba(0,0,0,0.03)',
                    },
                    borderRadius: {
                        lg: '0.75rem',
                        xl: '0.75rem', 
                        '2xl': '1rem',
                        '3xl': '1.5rem',
                    },
                    keyframes: {
                        pulse: {
                          '0%, 100%': { transform: 'scale(1)', boxShadow: '0 0 0 0 rgba(14, 165, 233, 0.4)' }, // primary color
                          '50%': { transform: 'scale(1.05)', boxShadow: '0 0 0 10px rgba(14, 165, 233, 0)' },
                        },
                        shine: { 
                          '0%': { transform: 'translateX(-100%) translateY(-100%) rotate(45deg)' },
                          '100%': { transform: 'translateX(100%) translateY(100%) rotate(45deg)' },
                        }
                    },
                    animation: {
                        'pulse-slow': 'pulse 2.5s infinite',
                        'shine-once': 'shine 1.5s ease-in-out',
                    }
                }
            }
        }
    </script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/aquawolf04/font-awesome-pro@5cd1511/css/all.css">
    
    <!-- External Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: theme('colors.background');
            color: theme('colors.foreground');
        }
        
        /* Custom focus styles */
        input:focus, select:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Smooth transitions for form elements */
        input, select, button {
            transition: all 0.3s ease;
        }
        
        /* Enhanced button hover effects */
        button:hover {
            transform: translateY(-1px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        /* Enhanced form field styling */
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"], select {
            font-size: 16px; /* Prevents zoom on iOS */
        }
        
        /* Better checkbox styling */
        input[type="checkbox"] {
            accent-color: rgb(59 130 246);
        }
        
        /* Ensure icons are properly positioned */
        .relative .absolute {
            z-index: 10;
        }
        
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
            pointer-events: none;
        }
        
        @keyframes  ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .step-content {
            min-height: 320px;
        }
    </style>
</head>

<body class="font-sans bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex min-h-screen">
    <!-- Logo at Top Left Corner -->
    <div class="fixed top-4 left-4 z-50">
        <div class="relative bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-2xl p-3 border border-gray-200/50 dark:border-gray-700/50">
            <img src="http://pace-services.com.ng/storage/app/public/photos/OTORjZOIcOMssWAFPewvjQx4lo2HoYvn5aLKVeot.png" alt="Logo" class="h-10">
        </div>
    </div>
    
    <!-- Dark Mode Toggle - Floating button -->
    <div class="fixed top-4 right-4 z-50">
        <button @click="darkMode = !darkMode; localStorage.setItem('darkMode', darkMode)" 
                class="dark-mode-toggle p-3 rounded-2xl bg-white/80 dark:bg-gray-800/80 text-gray-700 dark:text-gray-300 shadow-lg hover:shadow-xl border border-gray-200/50 dark:border-gray-700/50 backdrop-blur-xl transition-all duration-300 hover:scale-110"
                :title="darkMode ? 'Switch to Light Mode' : 'Switch to Dark Mode'">
            <i class="fa-solid fa-sun h-5 w-5" x-show="darkMode"></i>
            <i class="fa-solid fa-moon h-5 w-5" x-show="!darkMode"></i>
        </button>
    </div>
    
    <!-- Main Content -->
    <div class="w-full flex flex-col justify-center items-center p-3 lg:p-8 bg-gray-50/50 dark:bg-gray-900/50 backdrop-blur-sm min-h-screen">
        <div class="w-full max-w-sm">
            <!-- Mobile Header -->
            <div class="text-center mb-6">
                <h1 class="text-xl font-bold text-gray-900 dark:text-white mb-1">Create Wallet</h1>
                <p class="text-sm text-gray-600 dark:text-gray-400">Join WealthNetTrader today</p>
            </div>
            
           <!-- Registration Card -->
<div class="bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-gray-200/50 dark:border-gray-700/50 overflow-hidden">
    <!-- Progress Header -->
    <div class="px-6 pt-6 pb-4 border-b border-gray-100/50 dark:border-gray-700/50">
        <div class="flex justify-between items-center mb-3">
            <h2 class="text-lg font-bold text-gray-900 dark:text-white">Create Wallet</h2>
            <span class="text-xs font-medium text-gray-500 dark:text-gray-400">Step <span id="current-step">1</span> of 2</span>
        </div>
        
        <!-- Progress Bar -->
        <div class="h-1.5 w-full bg-gray-200 dark:bg-gray-600 rounded-full overflow-hidden mb-2">
            <div id="progress-bar" class="h-full bg-gradient-to-r from-primary-600 to-primary-700 rounded-full transition-all duration-500 ease-in-out" style="width: 50%"></div>
        </div>
        
        <!-- Step Indicators -->
        <div class="flex justify-between text-xs">
            <div class="flex flex-col items-center">
                <div id="step-1-indicator" class="w-6 h-6 rounded-full bg-primary-600 text-white flex items-center justify-center mb-1">
                    <i class="fas fa-user text-xs"></i>
                </div>
                <span class="text-primary-600 dark:text-primary-400 font-medium">Basic Info</span>
            </div>
            <div class="flex flex-col items-center">
                <div id="step-2-indicator" class="w-6 h-6 rounded-full bg-gray-300 dark:bg-gray-600 text-gray-500 flex items-center justify-center mb-1">
                    <i class="fas fa-lock text-xs"></i>
                </div>
                <span class="text-gray-500 dark:text-gray-400">Security</span>
            </div>
        </div>
    </div>
    
    <!-- Form Container -->
    <div class="px-6 pb-6 pt-4">
        <form method="POST" action="{% url 'userprofile:register' %}" id="registration-form" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="hidden" name="a" value="signup">
            <input type="hidden" name="action" value="signup">

            {% if user_form.non_field_errors %}
              <div class="mb-3 text-red-500">
                {% for error in user_form.non_field_errors %}
                  <p>{{ error }}</p>
                {% endfor %}
              </div>
            {% endif %}

            <!-- Step 1: Profile Information -->
            <div id="step-1" class="step-content">
                <div class="text-center mb-4">
                    <div class="inline-flex items-center justify-center w-12 h-12 rounded-xl bg-primary-100/50 dark:bg-primary-800/50 backdrop-blur-sm mb-3">
                        <i class="fas fa-user text-lg text-primary-600 dark:text-primary-300"></i>
                    </div>
                    <h3 class="text-sm font-bold text-gray-900 dark:text-white mb-1">Profile Information</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">Tell us about yourself</p>
                </div>

                <div class="space-y-3">
                    <!-- Username -->
                    <div class="space-y-1">
                        <label for="{{ user_form.username.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Username *</label>
                        {{ user_form.username|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
                        {{ user_form.username.errors }}
                    </div>

                    <!-- Email -->
                    <div class="space-y-1">
                        <label for="{{ user_form.email.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Email *</label>
                        {{ user_form.email|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
                        {{ user_form.email.errors }}
                    </div>

                    <!-- Phone Number -->
                    <div class="space-y-1">
                        <label for="{{ profile_form.phone_number.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Phone Number</label>
                        {{ profile_form.phone_number|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
                        {{ profile_form.phone_number.errors }}
                    </div>

                    <!-- Country -->
                    <div class="space-y-1">
                        <label for="{{ profile_form.country.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Country</label>
                        <select class="w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" id="{{ profile_form.country.id_for_label }}" name="{{ profile_form.country.html_name }}">
                            {% for option in profile_form.country.field.choices %}
                                <option value="{{ option.0 }}" {% if option.0 == profile_form.country.value %}selected{% endif %}>
                                    {{ option.1 }}
                                </option>
                            {% endfor %}
                        </select>
                        {{ profile_form.country.errors }}
                    </div>
                </div>
            </div>

            <!-- Step 2: Security Information -->
            <div id="step-2" class="step-content" style="display:none;">
                <div class="text-center mb-4">
                    <div class="inline-flex items-center justify-center w-12 h-12 rounded-xl bg-primary-100/50 dark:bg-primary-800/50 backdrop-blur-sm mb-3">
                        <i class="fas fa-lock text-lg text-primary-600 dark:text-primary-300"></i>
                    </div>
                    <h3 class="text-sm font-bold text-gray-900 dark:text-white mb-1">Security Setup</h3>
                    <p class="text-xs text-gray-600 dark:text-gray-400">Secure your account</p>
                </div>

                <div class="space-y-3">
                    <!-- Referral Code -->
                    <div class="space-y-1">
                        <label for="{{ profile_form.referral_bonus.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Referral Code</label>
                        {{ profile_form.referral_bonus|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
                        {{ profile_form.referral_bonus.errors }}
                    </div>

                    <!-- Password -->
                    <div class="space-y-1">
                        <label for="{{ user_form.password1.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Password *</label>
                        {{ user_form.password1|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
                        {{ user_form.password1.errors }}
                    </div>

                    <!-- Confirm Password -->
                    <div class="space-y-1">
                        <label for="{{ user_form.password2.id_for_label }}" class="block text-xs font-semibold text-gray-700 dark:text-gray-300">Confirm Password *</label>
                        {{ user_form.password2|add_class:"w-full pl-3 pr-3 py-3 border border-gray-300/50 dark:border-gray-600/50 rounded-xl bg-gray-50/50 dark:bg-gray-700/50 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-all duration-300 text-sm" }}
                        {{ user_form.password2.errors }}
                    </div>

                    <!-- Terms -->
                    <div class="flex items-start space-x-2 pt-1">
                        <input type="checkbox" id="terms" name="terms" class="mt-1 w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2" required>
                        <label for="terms" class="text-xs text-gray-600 dark:text-gray-400 leading-relaxed">
                            I agree to the 
                            <a href="#" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium">Terms of Service</a> 
                            and 
                            <a href="#" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium">Privacy Policy</a>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between pt-4">
                <button type="button" id="prev-btn" class="px-4 py-3 bg-gray-100/90 dark:bg-gray-700/90 hover:bg-gray-200/90 dark:hover:bg-gray-600/90 text-gray-800 dark:text-gray-200 font-medium rounded-xl transition-all duration-300 flex items-center group text-sm">Previous</button>
                <button type="button" id="next-btn" class="ml-auto px-4 py-3 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 dark:from-primary-700 dark:to-primary-800 dark:hover:from-primary-600 dark:hover:to-primary-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 flex items-center group text-sm">Proceed</button>
                <button type="submit" id="submit-btn" class="ml-auto px-4 py-3 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 flex items-center group text-sm" style="display:none;">Create Account</button>
            </div>
        </form>

        <!-- Login Link -->
        <div class="mt-6 text-center">
            <p class="text-sm text-gray-600 dark:text-gray-400">
                Already have a Wallet? 
                <a href="{% url 'userprofile:login' %}" class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-semibold transition-colors">
                    Sign In
                </a>
            </p>
        </div>
    </div>
    
    <!-- Footer -->
    <div class="mt-6 text-center">
        <p class="text-xs text-gray-500 dark:text-gray-500 max-w-xs mx-auto leading-relaxed">
            &copy; 2021 WealthNetTrader. All Rights Reserved.
        </p>
    </div>
</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
$(document).ready(function(){
    let currentStep = 1;
    const totalSteps = 2;

    function showStep(step){
        $('.step-content').hide();
        $('#step-'+step).fadeIn(200);

        // Update buttons
        if(step === 1){
            $('#prev-btn').hide();
            $('#next-btn').show();
            $('#submit-btn').hide();
        } else if(step === totalSteps){
            $('#prev-btn').show();
            $('#next-btn').hide();
            $('#submit-btn').show();
        } else {
            $('#prev-btn').show();
            $('#next-btn').show();
            $('#submit-btn').hide();
        }

        // Update progress bar
        const progress = (step / totalSteps) * 100;
        $('#progress-bar').css('width', progress + '%');

        // Update step indicators
        for(let i=1;i<=totalSteps;i++){
            const indicator = $('#step-'+i+'-indicator');
            const label = indicator.next('span');
            if(i<=step){
                indicator.removeClass('bg-gray-300 dark:bg-gray-600 text-gray-500')
                         .addClass('bg-primary-600 text-white');
                label.removeClass('text-gray-500 dark:text-gray-400')
                     .addClass('text-primary-600 dark:text-primary-400 font-medium');
            } else {
                indicator.removeClass('bg-primary-600 text-white')
                         .addClass('bg-gray-300 dark:bg-gray-600 text-gray-500');
                label.removeClass('text-primary-600 dark:text-primary-400 font-medium')
                     .addClass('text-gray-500 dark:text-gray-400');
            }
        }

        $('#current-step').text(step);
    }

    // Navigation button clicks
    $('#next-btn').click(function(){
        if(currentStep < totalSteps){
            currentStep++;
            showStep(currentStep);
        }
    });
    $('#prev-btn').click(function(){
        if(currentStep >1){
            currentStep--;
            showStep(currentStep);
        }
    });

    showStep(currentStep); // initialize
});
</script>
